# sharp-knife

**帮助编写高性能的多任务并行调度的框架，简单易使用**

> **The framework help you coding a high-performance program easily**

### 为什么会有这个框架

  在电商业务中在首页或商品列表页、商详页需要展示大量的信息，在如今微服务、分布式的架构设计下，通常完成一个页面的渲染请求需要扩散出N个读取请求。每一个读取请求都可能要通过RPC或Rest接口
调用远程服务获取数据，而这些接口获取的数据之间又有前后依赖关系，有一些又没有。为了提高请求的处理速度自然会使用线程池的方式。普通线程池无法做到任务的编排和自动触发，无法对每个任务的执行结果
进行通知和使用。

  > 此框架是 *国内头部二手电商公司转转，内部并行任务调度框架的雏形* 。相同的解决思路，不同的代码编写。
  
  > 转转卖场，是电商业务中的服务聚合层，使用此类解决方案成功经受618、双十一等严苛流量洪峰考验。

  sharp-knife帮助解决复杂业务场景下多任务需要并行执行和有依赖顺序时，简单高效地编写并行处理程序。
  

### 使用场景

#### 复杂的任务任意编排场景
  
  > 举例：转转卖场商品列表

在电商业务中，由于复杂的业务信息和微服务架构设计下，商品列表页要展示的信息非常多，背后需要处理的流程也是纷繁复杂。
举例其中的重要信息:

1. 根据策略，调搜索或推荐服务，获取根据商品ID信息
2. 通过商品ID获取商品基础、扩展信息
3. 获取商品属性、标签信息
4. 获取商品优惠券信息
5. 获取用户个性化业务信息
6. ...

往往还需要根据前面接口获取的信息决定下一步走什么策略或要不要执行逻辑，也就是说接口调用之间有依赖关系。如何处理有依赖关系的接口，让其按照工程师预期的顺序执行。以及并行请求无依赖关系的
接口，以便提高流程的处理速度。其实这就像是一副有向无环图，每个接口或计算逻辑可以封装成一个任务节点，有依赖关系和没有依赖的节点编排起来，交给框架自动调度并行执行。

例如下图的编排场景，是转转卖场商列中简化的任务链路图

<img src="https://user-images.githubusercontent.com/19208259/179020912-4ef13360-c316-4566-84a6-19d62632849c.png" width="680px"/>


### 最佳实践

- Maven坐标

- sharp-knife中的类

  1. `ScheduleRequest`类是面向用户的，封装用户请求的对象

  2. `ConcurrentScheduler`类是框架的核心接口，并行执行器由它接收用户提交的`ScheduleRequest`并开始执行对应的任务链路图

  3. `TaskType`抽象类，代表了一系列任务节点的身份特征。用户自定义子类继承并实现它，在任务节点类上声明此类bean名称，完成任务链路图的聚合构建

  4. `Ctx`

  5. `Res`

  6. `ExecutionResult`


- 示例代码



### 未来要做的事儿

### 测试的工程

### 问题反馈

